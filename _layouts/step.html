---
layout: default
# Managed by BriqueParBrique/nouvelle-brique — do not edit in brick repos
---

{% assign steps = site.data.steps %}
{% assign total = steps | size %}
{% assign current_index = nil %}
{% assign current_step_data = nil %}

{% for s in steps %}
  {% assign step_slug = page.url | remove: '/' %}
  {% if s.file == step_slug %}
    {% assign current_index = forloop.index0 %}
    {% assign current_step_data = s %}
  {% endif %}
{% endfor %}

{% assign step_number = current_index | plus: 1 %}
{% assign word_count = content | strip_html | number_of_words %}
{% assign reading_time = word_count | divided_by: 100 %}
{% if reading_time == 0 %}{% assign reading_time = 1 %}{% endif %}

<article class="step-container" data-step="{{ page.url | remove: '/' }}">

  <div class="progress-bar" role="progressbar" aria-valuenow="{{ step_number }}" aria-valuemin="1" aria-valuemax="{{ total }}" aria-label="Progression : étape {{ step_number }} sur {{ total }}">
    <div class="progress-bar-fill" style="width: {{ step_number | times: 100 | divided_by: total }}%"></div>
  </div>

  <div class="step-header">
    <div class="step-meta">
      <span class="step-number">Étape {{ step_number }}/{{ total }}</span>
      <span class="step-reading-time" aria-label="Temps de lecture estimé">{{ reading_time }} min de lecture</span>
    </div>
    <h1 class="step-title">{{ page.title }}</h1>
  </div>

  {% if current_step_data.requires %}
  <div class="step-prerequisite" data-requires="{{ current_step_data.requires }}" role="note">
    <strong>Prérequis :</strong> Il est recommandé de compléter l'étape
    {% for s in steps %}
      {% if s.file == current_step_data.requires %}
        <a href="{{ s.file | prepend: '/' | append: '/' | relative_url }}">{{ s.title }}</a>
      {% endif %}
    {% endfor %}
    avant de continuer.
  </div>
  {% endif %}

  <!-- Table of contents (generated by JS from h2/h3) -->
  <nav class="step-toc" id="step-toc" aria-label="Table des matières">
    <button class="step-toc-toggle" aria-expanded="true" aria-controls="step-toc-list">
      Sommaire
      <span class="step-toc-icon" aria-hidden="true">▾</span>
    </button>
    <ol class="step-toc-list" id="step-toc-list"></ol>
  </nav>

  <div class="step-content">
    {{ content }}
  </div>

  <!-- Completion checkbox -->
  <div class="step-completion">
    <label class="step-completion-label">
      <input type="checkbox" class="step-completion-checkbox" id="step-complete-checkbox">
      <span class="step-completion-checkmark"></span>
      <span class="step-completion-text">Marquer cette étape comme terminée</span>
    </label>
  </div>

  <nav class="step-nav" aria-label="Navigation entre étapes">
    {% if current_index > 0 %}
      {% assign prev_index = current_index | minus: 1 %}
      {% assign prev_step = steps[prev_index] %}
      <a href="{{ prev_step.file | prepend: '/' | append: '/' | relative_url }}" class="step-nav-link step-nav-prev">
        ← {{ prev_step.title }}
      </a>
    {% else %}
      <span class="step-nav-link step-nav-placeholder"></span>
    {% endif %}

    {% assign last_index = total | minus: 1 %}
    {% if current_index < last_index %}
      {% assign next_index = current_index | plus: 1 %}
      {% assign next_step = steps[next_index] %}
      <a href="{{ next_step.file | prepend: '/' | append: '/' | relative_url }}" class="step-nav-link step-nav-next">
        {{ next_step.title }} →
      </a>
    {% else %}
      <a href="{{ '/' | relative_url }}" class="step-nav-link step-nav-next step-nav-finish">
        Terminer ✓
      </a>
    {% endif %}
  </nav>

  <!-- Keyboard navigation hint -->
  <div class="keyboard-hint" aria-hidden="true">
    Utilisez <kbd>←</kbd> <kbd>→</kbd> pour naviguer entre les étapes
  </div>

</article>
